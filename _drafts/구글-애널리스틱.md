---
layout: post
title: 구글 애널리스틱
---
https://chinsun9.github.io/2020/11/20/github-blog-page-google-analytics%EB%A1%9C-%EC%B8%A1%EC%A0%95%ED%95%98%EA%B8%B0/

# Google Analytics 설정

GA 계정 및 속성 만들기

1. https://analytics.google.com/ 으로 이동하여 측정 시작을 클릭한다.
2.
![image](https://user-images.githubusercontent.com/53047744/189783909-aa76b12b-8ede-4bcc-b17c-20025863ca2e.png)

2. 계정 설정, 속성 설정, 비즈니스 정보를 입력하고 만들기 버튼을 누른다.
속성을 설정할 때 고급 옵션에서 유니버설 애널리틱스 속성 만들기를 체크하여 자신의 블로그 링크를 넣고 `Google 애널리틱스 4 속성과 유니버설 애널리틱스 속성 둘 다 만들기`와 `Google 애널리틱스 4 속성에 대해 향상된 측정 사용 설정`을 체크한다.

![image](https://user-images.githubusercontent.com/53047744/189789432-cfbbb808-8f2c-4a35-b966-713ffa7418b4.png)

![image](https://user-images.githubusercontent.com/53047744/190383008-e2b89487-89bc-40eb-a9a6-9be32828d467.png)


3. 웹 데이터 스트림에서 블로그 주소를 입력하고 스트림 만들기 버튼을 누른다.
4.
![image](https://user-images.githubusercontent.com/53047744/189789833-04b61c40-2c86-4314-b7c6-e4aaaa2c35cb.png)

4. 웹 스트림 세부정보에서 측정 ID를 복사한다.
예전에는 추적 ID였지만 명칭이 측정 ID로 바꼈다고 한다.

5. _config.yml 파일에서 google_analytics의 id란에 복사한 측정 ID를 입력한다.

![image](https://user-images.githubusercontent.com/53047744/189790670-0c068a28-73c3-45f7-b6a3-5777f6fdc6cd.png)

이렇게 하여 push하면 실시간으로 트래픽을 모니터링할 수 있다.

![image](https://user-images.githubusercontent.com/53047744/189792157-c977b1a9-40a6-4e92-993c-7e3b64e8b7e5.png)

# Page Views 설정

1. https://console.cloud.google.com/appengine 으로 이동하여 애플리케이션 만들기 클릭

![image](https://user-images.githubusercontent.com/53047744/189792066-3665ea90-bad3-4002-b99a-b8a9d971d20a.png)

2. 위치는 한국으로 한다. asia-northeast3 를 선택하면 한국으로 위치가 잡힌다.

![image](https://user-images.githubusercontent.com/53047744/189792265-8e57a271-6b94-425f-8695-6e35562748b9.png)

3. 리소스의 Language를 Python으로 선택하고 Environment를 표준으로 선택

![image](https://user-images.githubusercontent.com/53047744/189792847-1af03c4d-1b43-4d75-9fe5-f9c7f76267bf.png)

4. 왼쪽 상단 메뉴 버튼을 눌러서 API 및 서비스 이동 탭의 사용 설정된 API 및 서비스로 이동

![image](https://user-images.githubusercontent.com/53047744/189793588-3f5ebabb-6d09-4ead-9b2d-4afeded5c6e0.png)

5. Google Analytics API를 검색하여 사용 버튼 클릭

![image](https://user-images.githubusercontent.com/53047744/189794007-7e10b049-b7e5-475f-beb1-f53ac8b85f93.png)

![image](https://user-images.githubusercontent.com/53047744/189794173-04888aed-43a2-4b81-a3d0-ef852301933c.png)

6. 왼쪽에서 OAuth 동의 화면을 클릭한다.
![image](https://user-images.githubusercontent.com/53047744/189794374-3370ebda-a9b9-4ad5-8313-0952b1cc122f.png)

7. 블로그가 공개적으로 호스팅 될거니 외부를 선택하여 만들기 버튼 클릭
![image](https://user-images.githubusercontent.com/53047744/189794559-fc587f3f-310f-41ab-9b14-ba7e0c499cf8.png)

8. 적어야 할 내용들을 적어준다.

![image](https://user-images.githubusercontent.com/53047744/189794895-1f2bbd41-ae4f-48d9-a4c4-3d99aad03407.png)
---
9. 왼쪽 메뉴에서 사용자 인증 정보 탭으로 이동해 사용자 인증 정보 만들기의 OAuth 클라이언트 ID를 클릭
![image](https://user-images.githubusercontent.com/53047744/189795780-7210f9ef-aa83-4181-894a-5b260b1341a8.png)
---

10. 애플리케이션 유형은 웹 애플리케이션 선택, 승인도니 리디렉션 URI에는 아래의 형식으로 입력
`https://<project-id>.<region>.r.appspot.com/admin/auth`

project-id는 상단의 프로젝트 타이틀을 클릭하면 확인할 수 있다.

region은 du 를 입력해준다.

> 예시: https://civil-sprite-123456.du.r.appspot.com/admin/auth



~~나는 앞에서 선택했던 리전을 적는 거라고 생각했는데 그게 아니었다...
아무리 해도 관리자로 추가가 안 되어 사이트 주소를 보니 du라고 표시되어 있어서 URI의 region 부분을 du로 변경했더니 됐다.~~


그 후 만들기 버튼을 누른다.

11.  클라이언트 ID와 클라이언트 보안 비밀번호를 복사한다.

12.  플랫폼용 클라우드 SDK 다운로드 및 설치: https://cloud.google.com/sdk/docs/quickstart

Google Cloud CLI 설치 프로그램을 다운해서 설치

13. 결제 계정 만들기

14. API 라이브러리에서 Cloud Build API 사용




15. 왼쪽 상단 메뉴 버튼을 눌러서 결제탭으로 이동

![image](https://user-images.githubusercontent.com/53047744/189793588-3f5ebabb-6d09-4ead-9b2d-4afeded5c6e0.png)



# Google Analytics superProxy 설정

1. Github: https://github.com/googleanalytics/google-analytics-super-proxy 에서 Google Analytics superProxy 프로젝트를 Google Cloud CLI가 깔린 폴더 안에 있는 google-cloud-sdk에 붙여넣기 한다.

2. src/app.yaml파일 에서 첫 두 줄을 제거한다.

```diff
- application: your-project-id
- version: 1
```

3. 아까 복사했던 클라이언트 ID와 클라이언트 보안 비밀번호, URI, 임의의 XSRF_KEY를 src/config.py파일에 입력

4. cmd로 google-cloud-sdk/src 위치에서 app deploy를 한다.

5. deploy해서 배포된 서비스 주소 뒤에 /admin을 붙여서 접속하면 아래와 같은 페이지가 나옴

![image](https://user-images.githubusercontent.com/53047744/189834800-2124d5c3-2fd4-4133-ae74-8ab7e8f8ad52.png)

6. Authorize Access 버튼을 눌러 자신을 관리자로 추가하면 됨

![image](https://user-images.githubusercontent.com/53047744/189874698-c3fac5b7-6a24-47ce-a8f3-131581787a43.png)

Continue를 누르면 아래 화면이 나온다.

![image](https://user-images.githubusercontent.com/53047744/189876500-184d6b69-6be7-48d3-bd2a-4708bcebb9d3.png)

# Google Analytics Query 만들기

---
1. Analytics의 환경설정에서 계정 액세스 관리를 들어간다.

![image](https://user-images.githubusercontent.com/53047744/190299081-dcdaf68f-7f9f-4054-bfb0-b81620cccdc6.png)

2. 오른쪽 상단에 있는 + 버튼을 누른다.
3. 아래의 페이지가 나오는데 계정은 Google Cloud의 서비스 계정을 적어준다.

![image](https://user-images.githubusercontent.com/53047744/190299288-2221ef58-0ea7-47f3-9163-a3e6834089e6.png)

![image](https://user-images.githubusercontent.com/53047744/190299387-75260d26-9b8e-40db-b006-dd419e0c25c8.png)
---


4. 위 사진의 Create Query 버튼을 누른다.

![image](https://user-images.githubusercontent.com/53047744/189880732-11747f4f-58ad-40ce-8b6b-7e0de6e952fd.png)

2. https://ga-dev-tools.web.app/ga4/query-explorer/
